<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>カードコントローラー</title>
    <script src="https://cdn.jsdelivr.net/npm/peerjs@1.5.2/dist/peerjs.min.js"></script>
    <style>
        body { font-family: sans-serif; background: #222; color: white; padding: 20px; }
        .setup-area { background: #333; padding: 15px; border-radius: 8px; margin-bottom: 20px; }
        
        /* クラス選択タブ */
        .tabs { display: flex; flex-wrap: wrap; gap: 5px; margin-bottom: 20px; }
        .tab-btn { padding: 10px 20px; cursor: pointer; background: #444; border: none; color: white; border-radius: 5px; }
        .tab-btn.active { background: #007bff; }

        /* カード一覧 */
        .card-list { display: grid; grid-template-columns: repeat(auto-fill, minmax(120px, 1fr)); gap: 10px; display: none; }
        .card-list.active { display: grid; }
        .card-item { cursor: pointer; text-align: center; background: #333; padding: 5px; border-radius: 5px; transition: 0.2s; }
        .card-item:hover { background: #555; transform: scale(1.05); }
        .card-item img { width: 100%; border-radius: 3px; }

        /* 操作ボタン */
        .controls { position: fixed; bottom: 20px; right: 20px; display: flex; flex-direction: column; gap: 10px; }
        .hide-btn { padding: 15px 30px; background: #dc3545; color: white; border: none; border-radius: 50px; font-weight: bold; cursor: pointer; font-size: 1.2rem; box-shadow: 0 4px 10px rgba(0,0,0,0.3); }
    </style>
</head>
<body>

    <div class="setup-area">
    <input type="text" id="target-id" placeholder="IDを入力">
    <button onclick="connectToOBS()">1. 接続</button>
    <hr>
    <label>表示する説明文：</label>
    <input type="text" id="custom-text" style="width: 300px;" placeholder="例：このターン、フォロワーを+1/+1する">
</div>

<script>
    // データ構造を「ファイル名」から「オブジェクト」に変更
    const classes = {
        "エルフ": [
            { name: "リザ", file: "liza.png", desc: "強力なサーチ能力を持つ" },
            { name: "カシオペア", file: "casio.png", desc: "盤面を一掃する全体攻撃" }
        ],
        // ...他のクラスも同様に設定
    };

    // カード生成部分のループ修正
    classes[className].forEach(card => {
        const imgPath = `images/${className}/${card.file}`;
        const item = document.createElement('div');
        item.className = 'card-item';
        // クリック時に「画像パス」と「説明文」を両方送るように修正
        item.onclick = () => {
            // 入力欄が空ならプリセットの説明文、入力があればそれを優先
            const msg = document.getElementById('custom-text').value || card.desc;
            sendCard(imgPath, msg);
        };
        // ...
    });

    function sendCard(url, text) {
        if(conn) conn.send({ action: 'show', url: url, text: text });
    }
</script>
</body>
</html>
